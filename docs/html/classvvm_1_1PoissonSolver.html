<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VVM2D: vvm::PoissonSolver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VVM2D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classvvm_1_1PoissonSolver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classvvm_1_1PoissonSolver-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">vvm::PoissonSolver Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Declare_8hpp_source.html">Declare.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for vvm::PoissonSolver:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvvm_1_1PoissonSolver__coll__graph.svg" width="50" height="27"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a03f3af096f7aa1861ee6512f41b5298f" id="r_a03f3af096f7aa1861ee6512f41b5298f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03f3af096f7aa1861ee6512f41b5298f">cal_w</a> (<a class="el" href="classvvm.html">vvm</a> &amp;)</td></tr>
<tr class="separator:a03f3af096f7aa1861ee6512f41b5298f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741f59b97f794a79a15fd919b3b2501e" id="r_a741f59b97f794a79a15fd919b3b2501e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a741f59b97f794a79a15fd919b3b2501e">cal_u</a> (<a class="el" href="classvvm.html">vvm</a> &amp;)</td></tr>
<tr class="separator:a741f59b97f794a79a15fd919b3b2501e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47ac6e26a9dde6ed72a178dcb92d3bab" id="r_a47ac6e26a9dde6ed72a178dcb92d3bab"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47ac6e26a9dde6ed72a178dcb92d3bab">pubarTop_pt</a> (<a class="el" href="classvvm.html">vvm</a> &amp;)</td></tr>
<tr class="separator:a47ac6e26a9dde6ed72a178dcb92d3bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="Declare_8hpp_source.html#l00115">115</a> of file <a class="el" href="Declare_8hpp_source.html">Declare.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a741f59b97f794a79a15fd919b3b2501e" name="a741f59b97f794a79a15fd919b3b2501e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741f59b97f794a79a15fd919b3b2501e">&#9670;&#160;</a></span>cal_u()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vvm::PoissonSolver::cal_u </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classvvm.html">vvm</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>model</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PoissonSolver_8cpp_source.html#l00366">366</a> of file <a class="el" href="PoissonSolver_8cpp_source.html">PoissonSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  366</span>                                       {</div>
<div class="line"><span class="lineno">  367</span><span class="preprocessor">    #if defined(PETSC)</span></div>
<div class="line"><span class="lineno">  368</span>        Vec y, h;</div>
<div class="line"><span class="lineno">  369</span>        Mat <a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>;</div>
<div class="line"><span class="lineno">  370</span>        KSP ksp;</div>
<div class="line"><span class="lineno">  371</span>       </div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordtype">int</span> j[3];</div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordtype">double</span> v[3];</div>
<div class="line"><span class="lineno">  374</span>        </div>
<div class="line"><span class="lineno">  375</span>        PetscInt m = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2;</div>
<div class="line"><span class="lineno">  376</span>    </div>
<div class="line"><span class="lineno">  377</span>        <span class="comment">// Create vectors</span></div>
<div class="line"><span class="lineno">  378</span>        VecCreate(PETSC_COMM_WORLD, &amp;y);</div>
<div class="line"><span class="lineno">  379</span>        VecSetSizes(y, PETSC_DECIDE, m);</div>
<div class="line"><span class="lineno">  380</span>        VecSetFromOptions(y);</div>
<div class="line"><span class="lineno">  381</span>        VecDuplicate(y, &amp;h);</div>
<div class="line"><span class="lineno">  382</span><span class="preprocessor">        #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  383</span>            Vec y_ans;</div>
<div class="line"><span class="lineno">  384</span>            VecDuplicate(y, &amp;y_ans);</div>
<div class="line"><span class="lineno">  385</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        <span class="comment">// Create the matrix</span></div>
<div class="line"><span class="lineno">  388</span>        MatCreate(PETSC_COMM_WORLD, &amp;<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>);</div>
<div class="line"><span class="lineno">  389</span>        MatSetSizes(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, PETSC_DECIDE, PETSC_DECIDE, m, m);</div>
<div class="line"><span class="lineno">  390</span>        MatSetFromOptions(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>);</div>
<div class="line"><span class="lineno">  391</span>        MatSetUp(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>);</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>        <span class="keywordtype">int</span> startind = 0, endind = 0;</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  395</span>            <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><span class="lineno">  396</span>                <span class="comment">// v[0] = -2.*model.rdx2 + POISSONPARAMU; v[1] = 1.*model.rdx2; v[2] = 1.*model.rdx2;</span></div>
<div class="line"><span class="lineno">  397</span>                v[0] = -2. + <a class="code hl_define" href="Config_8hpp.html#ab22842bcdca3b2d9a2c60e78326e45bb">POISSONPARAMU</a>; v[1] = 1.; v[2] = 1.;</div>
<div class="line"><span class="lineno">  398</span>                j[0] = 0; j[1] = 1; j[2] = (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-1;</div>
<div class="line"><span class="lineno">  399</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, 1, &amp;i, 3, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  400</span>            }</div>
<div class="line"><span class="lineno">  401</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-1) {</div>
<div class="line"><span class="lineno">  402</span>                <span class="comment">// v[0] = 1.*model.rdx2; v[1] = 1.*model.rdx2; v[2] = -2.*model.rdx2 + POISSONPARAMU;</span></div>
<div class="line"><span class="lineno">  403</span>                v[0] = 1.; v[1] = 1.; v[2] = -2. + <a class="code hl_define" href="Config_8hpp.html#ab22842bcdca3b2d9a2c60e78326e45bb">POISSONPARAMU</a>;</div>
<div class="line"><span class="lineno">  404</span>                j[0] = 0; j[1] = (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-2; j[2] = (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-1;</div>
<div class="line"><span class="lineno">  405</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, 1, &amp;i, 3, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  406</span>            }</div>
<div class="line"><span class="lineno">  407</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  408</span>                <span class="comment">// v[0] = 1.*model.rdx2; v[1] = -2.*model.rdx2 + POISSONPARAMU; v[2] = 1.*model.rdx2;</span></div>
<div class="line"><span class="lineno">  409</span>                v[0] = 1.; v[1] = -2. + <a class="code hl_define" href="Config_8hpp.html#ab22842bcdca3b2d9a2c60e78326e45bb">POISSONPARAMU</a>; v[2] = 1.;</div>
<div class="line"><span class="lineno">  410</span>                j[0] = i-1; j[1] = i; j[2] = i+1;</div>
<div class="line"><span class="lineno">  411</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, 1, &amp;i, 3, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  412</span>            }</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span><span class="preprocessor">            #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  415</span>                <span class="keywordtype">double</span> y_ansval = exp(sin(i*i));</div>
<div class="line"><span class="lineno">  416</span>                VecSetValues(y_ans, 1, &amp;i, &amp;y_ansval, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  417</span><span class="preprocessor">            #else</span></div>
<div class="line"><span class="lineno">  418</span>                <span class="comment">// double hval = -(0. - model.rhow[model.nz-2] * model.w[i+1][model.nz-2]) / model.rhou[model.nz-2] * model.rdz;</span></div>
<div class="line"><span class="lineno">  419</span>                <span class="keywordtype">double</span> hval = -(0. - <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] * <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i+1][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2]) / <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] * <a class="code hl_define" href="Config_8hpp.html#af96a657aa0277ecc723296cc70efd9f4">dz</a>;</div>
<div class="line"><span class="lineno">  420</span>                VecSetValues(h, 1, &amp;i, &amp;hval, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  421</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno">  422</span>        }</div>
<div class="line"><span class="lineno">  423</span>        MatAssemblyBegin(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, MAT_FINAL_ASSEMBLY); MatAssemblyEnd(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno">  424</span>        VecAssemblyBegin(h); VecAssemblyEnd(h);</div>
<div class="line"><span class="lineno">  425</span>        <span class="comment">// MatView(G, PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno">  426</span>        <span class="comment">// VecView(b, PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno">  427</span><span class="preprocessor">        #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  428</span>            VecAssemblyBegin(y_ans); VecAssemblyEnd(y_ans);</div>
<div class="line"><span class="lineno">  429</span>            MatMult(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, y_ans, h);</div>
<div class="line"><span class="lineno">  430</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>        KSPCreate(PETSC_COMM_WORLD, &amp;ksp);</div>
<div class="line"><span class="lineno">  433</span>        KSPSetOperators(ksp, <a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>, <a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>);</div>
<div class="line"><span class="lineno">  434</span>        KSPSetFromOptions(ksp);</div>
<div class="line"><span class="lineno">  435</span>        KSPSetTolerances(ksp, 1E-15, 1E-9, 1E2, 10000);</div>
<div class="line"><span class="lineno">  436</span>        KSPSolve(ksp, h, y);</div>
<div class="line"><span class="lineno">  437</span>        <span class="comment">// VecView(x, PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span><span class="preprocessor">        #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  440</span>            <span class="keywordtype">double</span> error_norm;</div>
<div class="line"><span class="lineno">  441</span>            VecAXPY(y, -1, y_ans);</div>
<div class="line"><span class="lineno">  442</span>            VecNorm(y, NORM_2, &amp;error_norm);</div>
<div class="line"><span class="lineno">  443</span>            printf(<span class="stringliteral">&quot;Grid %d: Error = %1e\n&quot;</span>, m, error_norm);</div>
<div class="line"><span class="lineno">  444</span><span class="preprocessor">        #else</span></div>
<div class="line"><span class="lineno">  445</span>            PetscScalar *<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>;</div>
<div class="line"><span class="lineno">  446</span>            VecGetArray(y, &amp;<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  449</span>                <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[i+1] = <a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[i];</div>
<div class="line"><span class="lineno">  450</span>            }</div>
<div class="line"><span class="lineno">  451</span>            <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[0] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2];</div>
<div class="line"><span class="lineno">  452</span>            <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-1] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[1];</div>
<div class="line"><span class="lineno">  453</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordtype">int</span> iterNum = 0.;</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordtype">double</span> normError = 0.;</div>
<div class="line"><span class="lineno">  457</span>        KSPGetIterationNumber(ksp, &amp;iterNum);</div>
<div class="line"><span class="lineno">  458</span>        KSPGetResidualNorm(ksp, &amp;normError);</div>
<div class="line"><span class="lineno">  459</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Solving u: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;, Norm of error = &quot;</span> &lt;&lt; std::scientific &lt;&lt; normError &lt;&lt; <span class="stringliteral">&quot;, Iterations = &quot;</span> &lt;&lt; iterNum &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>        MatDestroy(&amp;<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>);</div>
<div class="line"><span class="lineno">  462</span>        VecDestroy(&amp;h);</div>
<div class="line"><span class="lineno">  463</span>        VecDestroy(&amp;y);</div>
<div class="line"><span class="lineno">  464</span>        KSPDestroy(&amp;ksp);</div>
<div class="line"><span class="lineno">  465</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">  466</span>        Eigen::VectorXd y(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2), h(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2);</div>
<div class="line"><span class="lineno">  467</span>        <span class="comment">// h</span></div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  469</span>            h(i-1) = -(0. - <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] * <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2]) / <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] * <a class="code hl_define" href="Config_8hpp.html#ae1d0d606e7eb860732925d6dbb82f18a">dx</a>;</div>
<div class="line"><span class="lineno">  470</span>        }</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>        Eigen::SparseMatrix&lt;double&gt; <a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a> = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>;</div>
<div class="line"><span class="lineno">  473</span>        Eigen::ConjugateGradient&lt;Eigen::SparseMatrix&lt;double&gt; &gt; solver_xi;</div>
<div class="line"><span class="lineno">  474</span>        <span class="comment">// Eigen::BiCGSTAB&lt;Eigen::SparseMatrix&lt;double&gt; &gt; solver_xi;</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="comment">// Eigen::SimplicialLDLT&lt;Eigen::SparseMatrix&lt;double&gt; &gt; solver_xi;</span></div>
<div class="line"><span class="lineno">  476</span>        solver_xi.setTolerance(1e-30);</div>
<div class="line"><span class="lineno">  477</span>        solver_xi.setMaxIterations(10000);</div>
<div class="line"><span class="lineno">  478</span>        solver_xi.compute(<a class="code hl_variable" href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">G</a>);</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">if</span> (solver_xi.info() != Eigen::Success) {</div>
<div class="line"><span class="lineno">  480</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;UUUUUUUU Warning!!!!!!!!!!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  481</span>        }</div>
<div class="line"><span class="lineno">  482</span>        y = solver_xi.solve(h);</div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">if</span> (solver_xi.info() != Eigen::Success) {</div>
<div class="line"><span class="lineno">  484</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;U Solve Warning!!!!!!!!!!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  485</span>        }</div>
<div class="line"><span class="lineno">  486</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;U:  #iterations:     &quot;</span> &lt;&lt; solver_xi.iterations() &lt;&lt; <span class="stringliteral">&quot;, estimated error: &quot;</span> &lt;&lt; std::scientific &lt;&lt;  solver_xi.error() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>        <span class="comment">// xi</span></div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  490</span>            <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[i] = y[i-1];</div>
<div class="line"><span class="lineno">  491</span>        }</div>
<div class="line"><span class="lineno">  492</span>        <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[0] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2];</div>
<div class="line"><span class="lineno">  493</span>        <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-1] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[1];</div>
<div class="line"><span class="lineno">  494</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="comment">// uxi</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  498</span>        <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#abb74b46a37b339933f113039b22744b7">uxi</a>[i] = (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[i] - <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">xi</a>[i-1]) * <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a3ca267ed2f973f92e35d839085baf702">rdx</a>;</div>
<div class="line"><span class="lineno">  499</span>    }</div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#abb74b46a37b339933f113039b22744b7">uxi</a>[0] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#abb74b46a37b339933f113039b22744b7">uxi</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2];</div>
<div class="line"><span class="lineno">  501</span>    <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#abb74b46a37b339933f113039b22744b7">uxi</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-1] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#abb74b46a37b339933f113039b22744b7">uxi</a>[1];</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>    <span class="comment">// u_top</span></div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  505</span>        <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#abb74b46a37b339933f113039b22744b7">uxi</a>[i] + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a2494ade44221bcd3aed164d73bf208f4">ubarTopp</a>;</div>
<div class="line"><span class="lineno">  506</span>    }</div>
<div class="line"><span class="lineno">  507</span>    <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[0][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2];</div>
<div class="line"><span class="lineno">  508</span>    <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-1][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[1][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2];</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="comment">// u</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordtype">double</span> area = 0.;</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3; k &gt;= 1; k--) {</div>
<div class="line"><span class="lineno">  514</span>            <span class="comment">// area += ((0.5*(model.rhow[k+2]*model.w[i][k+2] + model.rhow[k+1]*model.w[i][k+1]) - 0.5*(model.rhow[k+2]*model.w[i-1][k+2] + model.rhow[k+1]*model.w[i-1][k+1])) / model.rhou[k+1] * model.rdx - 0.5*(model.rhow[k+2]*model.zetap[i][k+2] + model.rhow[k+1]*model.zetap[i][k+1])) * -dz;</span></div>
<div class="line"><span class="lineno">  515</span>            </div>
<div class="line"><span class="lineno">  516</span>            area += ((<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][k+1]-<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i-1][k+1]) * <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a3ca267ed2f973f92e35d839085baf702">rdx</a> - <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k+1]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ae6a43e969fcfb9de0ba751369881a03f">zetap</a>[i][k+1]) * -<a class="code hl_define" href="Config_8hpp.html#af96a657aa0277ecc723296cc70efd9f4">dz</a>;</div>
<div class="line"><span class="lineno">  517</span>            <span class="comment">// area += ((model.w[i][k+1]-model.w[i-1][k+1]) * model.rdx - model.zetap[i][k+1]) * -dz;</span></div>
<div class="line"><span class="lineno">  518</span>            </div>
<div class="line"><span class="lineno">  519</span>            <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  520</span><span class="comment">            if (i == model.nz-3 || i == 1) area += ((model.w[i][k+1]-model.w[i-1][k+1]) * model.rdx - model.rhow[k+1]*model.zetap[i][k+1]) * -dz;</span></div>
<div class="line"><span class="lineno">  521</span><span class="comment">            else {</span></div>
<div class="line"><span class="lineno">  522</span><span class="comment">                double fa = ((0.5*(model.w[i][k+2] + model.w[i][k+1]) - 0.5*(model.w[i-1][k+2] + model.w[i-1][k+1])) * model.rdx - 0.5*(model.rhow[k+2]*model.zetap[i][k+2] + model.rhow[k+1]*model.zetap[i][k+1]));</span></div>
<div class="line"><span class="lineno">  523</span><span class="comment">                double fb = ((0.5*(model.w[i][k+1] + model.w[i][k]) - 0.5*(model.w[i-1][k+1] + model.w[i-1][k])) * model.rdx - 0.5*(model.rhow[k+1]*model.zetap[i][k+1] + model.rhow[k]*model.zetap[i][k]));</span></div>
<div class="line"><span class="lineno">  524</span><span class="comment">                double f_mid = ((model.w[i][k+1]-model.w[i-1][k+1]) * model.rdx - model.rhow[k+1]*model.zetap[i][k+1]);</span></div>
<div class="line"><span class="lineno">  525</span><span class="comment">                area += (-dz) / 6. * (fa + 4*f_mid + fb);</span></div>
<div class="line"><span class="lineno">  526</span><span class="comment">            }</span></div>
<div class="line"><span class="lineno">  527</span><span class="comment">            */</span></div>
<div class="line"><span class="lineno">  528</span>            <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][k] = area + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2];</div>
<div class="line"><span class="lineno">  529</span>        }</div>
<div class="line"><span class="lineno">  530</span>    }</div>
<div class="line"><span class="lineno">  531</span>    <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_function" href="classvvm.html#a0f7695aeeea1dac87393db3edfc7acd8">BoundaryProcess2D_center</a>(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>);</div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  533</span>}</div>
<div class="ttc" id="aConfig_8hpp_html_ab22842bcdca3b2d9a2c60e78326e45bb"><div class="ttname"><a href="Config_8hpp.html#ab22842bcdca3b2d9a2c60e78326e45bb">POISSONPARAMU</a></div><div class="ttdeci">#define POISSONPARAMU</div><div class="ttdef"><b>Definition</b> <a href="Config_8hpp_source.html#l00019">Config.hpp:19</a></div></div>
<div class="ttc" id="aConfig_8hpp_html_ae1d0d606e7eb860732925d6dbb82f18a"><div class="ttname"><a href="Config_8hpp.html#ae1d0d606e7eb860732925d6dbb82f18a">dx</a></div><div class="ttdeci">#define dx</div><div class="ttdef"><b>Definition</b> <a href="Config_8hpp_source.html#l00001">Config.hpp:1</a></div></div>
<div class="ttc" id="aConfig_8hpp_html_af96a657aa0277ecc723296cc70efd9f4"><div class="ttname"><a href="Config_8hpp.html#af96a657aa0277ecc723296cc70efd9f4">dz</a></div><div class="ttdeci">#define dz</div><div class="ttdef"><b>Definition</b> <a href="Config_8hpp_source.html#l00002">Config.hpp:2</a></div></div>
<div class="ttc" id="aclassvvm_html_a0f7695aeeea1dac87393db3edfc7acd8"><div class="ttname"><a href="classvvm.html#a0f7695aeeea1dac87393db3edfc7acd8">vvm::BoundaryProcess2D_center</a></div><div class="ttdeci">static void BoundaryProcess2D_center(double var[][NZ])</div><div class="ttdef"><b>Definition</b> <a href="Boundary_8cpp_source.html#l00009">Boundary.cpp:9</a></div></div>
<div class="ttc" id="aclassvvm_html_a1c19d7dc2ab861379c3c69c7e79bd5c8"><div class="ttname"><a href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">vvm::nz</a></div><div class="ttdeci">int nz</div><div class="ttdoc">Number of grid points in z direction.</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00036">Declare.hpp:36</a></div></div>
<div class="ttc" id="aclassvvm_html_a2494ade44221bcd3aed164d73bf208f4"><div class="ttname"><a href="classvvm.html#a2494ade44221bcd3aed164d73bf208f4">vvm::ubarTopp</a></div><div class="ttdeci">double ubarTopp</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00040">Declare.hpp:40</a></div></div>
<div class="ttc" id="aclassvvm_html_a2b0b1a4ac6932d797805238e973cc01d"><div class="ttname"><a href="classvvm.html#a2b0b1a4ac6932d797805238e973cc01d">vvm::G</a></div><div class="ttdeci">Eigen::SparseMatrix&lt; double &gt; G</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00114">Declare.hpp:114</a></div></div>
<div class="ttc" id="aclassvvm_html_a3ca267ed2f973f92e35d839085baf702"><div class="ttname"><a href="classvvm.html#a3ca267ed2f973f92e35d839085baf702">vvm::rdx</a></div><div class="ttdeci">double rdx</div><div class="ttdoc">1 / dx</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00029">Declare.hpp:29</a></div></div>
<div class="ttc" id="aclassvvm_html_a42bbd446ef820ca6930ed4c727cf17ea"><div class="ttname"><a href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">vvm::w</a></div><div class="ttdeci">double w[NX][NZ]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00050">Declare.hpp:50</a></div></div>
<div class="ttc" id="aclassvvm_html_a460b941aba46eeaf9d777d93ec472cc1"><div class="ttname"><a href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">vvm::rhou</a></div><div class="ttdeci">double rhou[NZ]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00043">Declare.hpp:43</a></div></div>
<div class="ttc" id="aclassvvm_html_a54019773003b18a98f267df45ee230bb"><div class="ttname"><a href="classvvm.html#a54019773003b18a98f267df45ee230bb">vvm::nx</a></div><div class="ttdeci">int nx</div><div class="ttdoc">Number of grid points in z direction.</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00035">Declare.hpp:35</a></div></div>
<div class="ttc" id="aclassvvm_html_a546ef99056f9c89ab84d5157b8400c9d"><div class="ttname"><a href="classvvm.html#a546ef99056f9c89ab84d5157b8400c9d">vvm::xi</a></div><div class="ttdeci">double xi[NX]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00044">Declare.hpp:44</a></div></div>
<div class="ttc" id="aclassvvm_html_a8f250b15a87e5698b512aed8c52ca1fa"><div class="ttname"><a href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">vvm::rhow</a></div><div class="ttdeci">double rhow[NZ]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00043">Declare.hpp:43</a></div></div>
<div class="ttc" id="aclassvvm_html_abb74b46a37b339933f113039b22744b7"><div class="ttname"><a href="classvvm.html#abb74b46a37b339933f113039b22744b7">vvm::uxi</a></div><div class="ttdeci">double uxi[NX]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00044">Declare.hpp:44</a></div></div>
<div class="ttc" id="aclassvvm_html_ad7c0652b11cf78af50e5b03e593e1774"><div class="ttname"><a href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">vvm::u</a></div><div class="ttdeci">double u[NX][NZ]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00050">Declare.hpp:50</a></div></div>
<div class="ttc" id="aclassvvm_html_ae6a43e969fcfb9de0ba751369881a03f"><div class="ttname"><a href="classvvm.html#ae6a43e969fcfb9de0ba751369881a03f">vvm::zetap</a></div><div class="ttdeci">double zetap[NX][NZ]</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00048">Declare.hpp:48</a></div></div>
<div class="ttc" id="amain_8cpp_html_a5e376a387fdce5400f2e8ed865388257"><div class="ttname"><a href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a></div><div class="ttdeci">vvm model</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00004">main.cpp:4</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvvm_1_1PoissonSolver_a741f59b97f794a79a15fd919b3b2501e_cgraph.svg" width="372" height="54"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvvm_1_1PoissonSolver_a741f59b97f794a79a15fd919b3b2501e_icgraph.svg" width="456" height="71"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a03f3af096f7aa1861ee6512f41b5298f" name="a03f3af096f7aa1861ee6512f41b5298f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f3af096f7aa1861ee6512f41b5298f">&#9670;&#160;</a></span>cal_w()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vvm::PoissonSolver::cal_w </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classvvm.html">vvm</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>model</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PoissonSolver_8cpp_source.html#l00183">183</a> of file <a class="el" href="PoissonSolver_8cpp_source.html">PoissonSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  183</span>                                       {</div>
<div class="line"><span class="lineno">  184</span><span class="preprocessor">    #if defined(PETSC) </span></div>
<div class="line"><span class="lineno">  185</span>        Vec x, b;</div>
<div class="line"><span class="lineno">  186</span>        Mat <a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>;</div>
<div class="line"><span class="lineno">  187</span>        KSP ksp;</div>
<div class="line"><span class="lineno">  188</span>       </div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordtype">int</span> j[5];</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordtype">double</span> v[5];</div>
<div class="line"><span class="lineno">  191</span>        </div>
<div class="line"><span class="lineno">  192</span>        PetscInt m = (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)*(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3);</div>
<div class="line"><span class="lineno">  193</span>    </div>
<div class="line"><span class="lineno">  194</span>        <span class="comment">// Create vectors</span></div>
<div class="line"><span class="lineno">  195</span>        VecCreate(PETSC_COMM_WORLD, &amp;x);</div>
<div class="line"><span class="lineno">  196</span>        VecSetSizes(x, PETSC_DECIDE, m);</div>
<div class="line"><span class="lineno">  197</span>        VecSetFromOptions(x);</div>
<div class="line"><span class="lineno">  198</span>        VecDuplicate(x, &amp;b);</div>
<div class="line"><span class="lineno">  199</span><span class="preprocessor">        #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  200</span>            Vec x_ans;</div>
<div class="line"><span class="lineno">  201</span>            VecDuplicate(x, &amp;x_ans);</div>
<div class="line"><span class="lineno">  202</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        <span class="comment">// Create the matrix</span></div>
<div class="line"><span class="lineno">  205</span>        MatCreate(PETSC_COMM_WORLD, &amp;<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>);</div>
<div class="line"><span class="lineno">  206</span>        MatSetSizes(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, PETSC_DECIDE, PETSC_DECIDE, m, m);</div>
<div class="line"><span class="lineno">  207</span>        MatSetFromOptions(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>);</div>
<div class="line"><span class="lineno">  208</span>        MatSetUp(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>);</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>        <span class="keywordtype">int</span> idx_i = 0, k = 1;</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)*(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3); i++) {    </div>
<div class="line"><span class="lineno">  212</span>            <span class="comment">// Height</span></div>
<div class="line"><span class="lineno">  213</span>            <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) == 0) k++;</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>            <span class="comment">// Diagonal</span></div>
<div class="line"><span class="lineno">  216</span>            <span class="comment">// v[0] = -(2. + (model.rhow[k]/model.rhou[k]) + (model.rhow[k]/model.rhou[k-1])) * model.rdx2 + POISSONPARAM;</span></div>
<div class="line"><span class="lineno">  217</span>            v[0] = -(2. + (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k]/<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[k]) + (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k]/<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[k-1])) + <a class="code hl_define" href="Config_8hpp.html#a6cc99de22fbfffb5c4432738ba6c74f8">POISSONPARAM</a>;</div>
<div class="line"><span class="lineno">  218</span>            j[0] = i;</div>
<div class="line"><span class="lineno">  219</span>            MatSetValues(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, 1, &amp;i, 1, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>            </div>
<div class="line"><span class="lineno">  222</span>            <span class="comment">// D</span></div>
<div class="line"><span class="lineno">  223</span>            <span class="comment">// Fill left right except the point near the boundaries</span></div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) != 0 &amp;&amp; i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) != (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-1) {</div>
<div class="line"><span class="lineno">  225</span>                <span class="comment">// v[0] = 1.*model.rdx2; v[1] = 1.*model.rdx2; </span></div>
<div class="line"><span class="lineno">  226</span>                v[0] = 1.; v[1] = 1.; </div>
<div class="line"><span class="lineno">  227</span>                j[0] = i-1; j[1] = i+1;</div>
<div class="line"><span class="lineno">  228</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, 1, &amp;i, 2, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  229</span>            }</div>
<div class="line"><span class="lineno">  230</span>            <span class="comment">// Fill the leftest point</span></div>
<div class="line"><span class="lineno">  231</span>            <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) == 0) {</div>
<div class="line"><span class="lineno">  232</span>                <span class="comment">// v[0] = 1.*model.rdx2; v[1] = 1.*model.rdx2;</span></div>
<div class="line"><span class="lineno">  233</span>                v[0] = 1.; v[1] = 1.;</div>
<div class="line"><span class="lineno">  234</span>                j[0] = i+1, j[1] = i+(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-1;</div>
<div class="line"><span class="lineno">  235</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, 1, &amp;i, 2, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  236</span>            }</div>
<div class="line"><span class="lineno">  237</span>        </div>
<div class="line"><span class="lineno">  238</span>            <span class="comment">// Fill the rightest point</span></div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) == (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)-1) {</div>
<div class="line"><span class="lineno">  240</span>                <span class="comment">// v[0] = 1.*model.rdx2; v[1] = 1.*model.rdx2;</span></div>
<div class="line"><span class="lineno">  241</span>                v[0] = 1.; v[1] = 1.;</div>
<div class="line"><span class="lineno">  242</span>                j[0] = i-(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)+1, j[1] = i-1;</div>
<div class="line"><span class="lineno">  243</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, 1, &amp;i, 2, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  244</span>            }</div>
<div class="line"><span class="lineno">  245</span>            </div>
<div class="line"><span class="lineno">  246</span>            <span class="comment">// E</span></div>
<div class="line"><span class="lineno">  247</span>            <span class="keywordflow">if</span> (i &lt; (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)*(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3-1)) {</div>
<div class="line"><span class="lineno">  248</span>                <span class="comment">// v[0] = model.rhow[k]/model.rhou[k] * model.rdx2;</span></div>
<div class="line"><span class="lineno">  249</span>                v[0] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k]/<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[k];</div>
<div class="line"><span class="lineno">  250</span>                j[0] = i+(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2);</div>
<div class="line"><span class="lineno">  251</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, 1, &amp;i, 1, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  252</span>            }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>            <span class="comment">// F</span></div>
<div class="line"><span class="lineno">  255</span>            <span class="keywordflow">if</span> (i &gt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) {</div>
<div class="line"><span class="lineno">  256</span>                <span class="comment">// v[0] = model.rhow[k]/model.rhou[k-1] * model.rdx2;</span></div>
<div class="line"><span class="lineno">  257</span>                v[0] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k]/<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[k-1];</div>
<div class="line"><span class="lineno">  258</span>                j[0] = i-(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2);</div>
<div class="line"><span class="lineno">  259</span>                MatSetValues(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, 1, &amp;i, 1, j, v, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  260</span>            }</div>
<div class="line"><span class="lineno">  261</span>            </div>
<div class="line"><span class="lineno">  262</span><span class="preprocessor">            #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  263</span>                <span class="keywordtype">double</span> x_ansval = exp(sin(i));</div>
<div class="line"><span class="lineno">  264</span>                VecSetValues(x_ans, 1, &amp;i, &amp;x_ansval, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  265</span><span class="preprocessor">            #else</span></div>
<div class="line"><span class="lineno">  266</span>                idx_i = (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)) + 1;</div>
<div class="line"><span class="lineno">  267</span>                <span class="comment">// double bval = model.rhow[k]*model.rhow[k] * (model.zetap[idx_i+1][k] - model.zetap[idx_i][k]) * model.rdx;</span></div>
<div class="line"><span class="lineno">  268</span>                <span class="keywordtype">double</span> bval = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k] * (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ae6a43e969fcfb9de0ba751369881a03f">zetap</a>[idx_i+1][k] - <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ae6a43e969fcfb9de0ba751369881a03f">zetap</a>[idx_i][k]) * <a class="code hl_define" href="Config_8hpp.html#ae1d0d606e7eb860732925d6dbb82f18a">dx</a>;</div>
<div class="line"><span class="lineno">  269</span>                VecSetValues(b, 1, &amp;i, &amp;bval, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  270</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno">  271</span>        }</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>        MatAssemblyBegin(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, MAT_FINAL_ASSEMBLY); MatAssemblyEnd(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno">  274</span>        VecAssemblyBegin(b); VecAssemblyEnd(b);</div>
<div class="line"><span class="lineno">  275</span>        <span class="comment">// MatView(A, PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno">  276</span>        <span class="comment">// VecView(b, PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno">  277</span><span class="preprocessor">        #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  278</span>            VecAssemblyBegin(x_ans); VecAssemblyEnd(x_ans);</div>
<div class="line"><span class="lineno">  279</span>            MatMult(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, x_ans, b);</div>
<div class="line"><span class="lineno">  280</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>        KSPCreate(PETSC_COMM_WORLD, &amp;ksp);</div>
<div class="line"><span class="lineno">  283</span>        KSPSetOperators(ksp, <a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>, <a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>);</div>
<div class="line"><span class="lineno">  284</span>        KSPSetFromOptions(ksp);</div>
<div class="line"><span class="lineno">  285</span>        KSPSetTolerances(ksp, 1E-30, 1E-12, 1E2, 10000);</div>
<div class="line"><span class="lineno">  286</span>        KSPSolve(ksp, b, x);</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span><span class="preprocessor">        #if defined(POISSONTEST)</span></div>
<div class="line"><span class="lineno">  289</span>            <span class="keywordtype">double</span> error_norm;</div>
<div class="line"><span class="lineno">  290</span>            VecAXPY(x, -1, x_ans);</div>
<div class="line"><span class="lineno">  291</span>            VecNorm(x, NORM_2, &amp;error_norm);</div>
<div class="line"><span class="lineno">  292</span>            printf(<span class="stringliteral">&quot;Grid %d: Error = %1e\n&quot;</span>, m, error_norm);</div>
<div class="line"><span class="lineno">  293</span><span class="preprocessor">        #else</span></div>
<div class="line"><span class="lineno">  294</span>            PetscScalar *x_arr;</div>
<div class="line"><span class="lineno">  295</span>            VecGetArray(x, &amp;x_arr);</div>
<div class="line"><span class="lineno">  296</span>            </div>
<div class="line"><span class="lineno">  297</span>            <span class="keywordtype">int</span> K = 1;</div>
<div class="line"><span class="lineno">  298</span>            <span class="keywordtype">int</span> I = 0;</div>
<div class="line"><span class="lineno">  299</span>            <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; m; i++) {</div>
<div class="line"><span class="lineno">  300</span>                I = (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)) + 1;</div>
<div class="line"><span class="lineno">  301</span>                <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2) == 0) K++;</div>
<div class="line"><span class="lineno">  302</span>                <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[I][K] = x_arr[i] / <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[K];</div>
<div class="line"><span class="lineno">  303</span>            }</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>            </div>
<div class="line"><span class="lineno">  306</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt;= <a class="code hl_define" href="Const_8hpp.html#a693aee47b2103d0a7fcd3a0a0dd4fb57">NZ</a>-2; k++) {</div>
<div class="line"><span class="lineno">  307</span>                <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[0][k] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[<a class="code hl_define" href="Const_8hpp.html#a4a9d32ff035c82119003134767948ebf">NX</a>-2][k];</div>
<div class="line"><span class="lineno">  308</span>                <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[<a class="code hl_define" href="Const_8hpp.html#a4a9d32ff035c82119003134767948ebf">NX</a>-1][k] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[1][k];</div>
<div class="line"><span class="lineno">  309</span>            }</div>
<div class="line"><span class="lineno">  310</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code hl_define" href="Const_8hpp.html#a4a9d32ff035c82119003134767948ebf">NX</a>-1; i++) {</div>
<div class="line"><span class="lineno">  311</span>                <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][0] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][1] = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][<a class="code hl_define" href="Const_8hpp.html#a693aee47b2103d0a7fcd3a0a0dd4fb57">NZ</a>-1] = 0.;</div>
<div class="line"><span class="lineno">  312</span>            }</div>
<div class="line"><span class="lineno">  313</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordtype">int</span> iterNum = 0.;</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordtype">double</span> normError = 0.;</div>
<div class="line"><span class="lineno">  316</span>        KSPGetIterationNumber(ksp, &amp;iterNum);</div>
<div class="line"><span class="lineno">  317</span>        KSPGetResidualNorm(ksp, &amp;normError);</div>
<div class="line"><span class="lineno">  318</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Solving w: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;, Norm of error = &quot;</span> &lt;&lt; std::scientific &lt;&lt; normError &lt;&lt; <span class="stringliteral">&quot;, Iterations = &quot;</span> &lt;&lt; iterNum &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>        MatDestroy(&amp;<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>);</div>
<div class="line"><span class="lineno">  321</span>        VecDestroy(&amp;b);</div>
<div class="line"><span class="lineno">  322</span>        VecDestroy(&amp;x);</div>
<div class="line"><span class="lineno">  323</span>        KSPDestroy(&amp;ksp);</div>
<div class="line"><span class="lineno">  324</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">  325</span>        <span class="comment">// eigen solver</span></div>
<div class="line"><span class="lineno">  326</span>        Eigen::VectorXd x((<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)*(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3)), b((<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2)*(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3));</div>
<div class="line"><span class="lineno">  327</span>    </div>
<div class="line"><span class="lineno">  328</span>        <span class="comment">// b</span></div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 2; k &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2; k++) {</div>
<div class="line"><span class="lineno">  331</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  332</span>                b(count) = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k] * (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ae6a43e969fcfb9de0ba751369881a03f">zetap</a>[i+1][k] - <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ae6a43e969fcfb9de0ba751369881a03f">zetap</a>[i][k]) * <a class="code hl_define" href="Config_8hpp.html#ae1d0d606e7eb860732925d6dbb82f18a">dx</a>;</div>
<div class="line"><span class="lineno">  333</span>                count++;</div>
<div class="line"><span class="lineno">  334</span>            }</div>
<div class="line"><span class="lineno">  335</span>        }</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>        <span class="comment">// Eigen::SimplicialLDLT&lt;Eigen::SparseMatrix&lt;double&gt; &gt; solver;</span></div>
<div class="line"><span class="lineno">  338</span>        Eigen::BiCGSTAB&lt;Eigen::SparseMatrix&lt;double&gt; &gt; solver;</div>
<div class="line"><span class="lineno">  339</span>        <span class="comment">// Eigen::ConjugateGradient&lt;Eigen::SparseMatrix&lt;double&gt; &gt; solver;</span></div>
<div class="line"><span class="lineno">  340</span>        solver.setTolerance(1e-30);</div>
<div class="line"><span class="lineno">  341</span>        solver.setMaxIterations(10000);</div>
<div class="line"><span class="lineno">  342</span>        Eigen::SparseMatrix&lt;double&gt; <a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a> = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>;</div>
<div class="line"><span class="lineno">  343</span>        solver.compute(<a class="code hl_variable" href="classvvm.html#ac87ca230e4801653418101e80a986b5b">A</a>);</div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">if</span> (solver.info() != Eigen::Success) {</div>
<div class="line"><span class="lineno">  345</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;WWWWWWWWW Warning!!!!!!!!!!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  346</span>        }</div>
<div class="line"><span class="lineno">  347</span>        x = solver.solve(b);</div>
<div class="line"><span class="lineno">  348</span>        <span class="keywordflow">if</span> (solver.info() != Eigen::Success) {</div>
<div class="line"><span class="lineno">  349</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;W Solve Warning!!!!!!!!!!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  350</span>        }</div>
<div class="line"><span class="lineno">  351</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;W:  #iterations:     &quot;</span> &lt;&lt; solver.iterations() &lt;&lt; <span class="stringliteral">&quot;, estimated error: &quot;</span> &lt;&lt; std::scientific &lt;&lt;  solver.error() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    </div>
<div class="line"><span class="lineno">  354</span>        <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 2; k &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2; k++) {</div>
<div class="line"><span class="lineno">  356</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-2; i++) {</div>
<div class="line"><span class="lineno">  357</span>                <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][k] = x[cnt] / <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a8f250b15a87e5698b512aed8c52ca1fa">rhow</a>[k];</div>
<div class="line"><span class="lineno">  358</span>                cnt++;</div>
<div class="line"><span class="lineno">  359</span>            }</div>
<div class="line"><span class="lineno">  360</span>        }</div>
<div class="line"><span class="lineno">  361</span>        <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_function" href="classvvm.html#a88f21d908dca06f5c725da83a36caf96">BoundaryProcess2D_westdown</a>(<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>);</div>
<div class="line"><span class="lineno">  362</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  364</span>}</div>
<div class="ttc" id="aConfig_8hpp_html_a6cc99de22fbfffb5c4432738ba6c74f8"><div class="ttname"><a href="Config_8hpp.html#a6cc99de22fbfffb5c4432738ba6c74f8">POISSONPARAM</a></div><div class="ttdeci">#define POISSONPARAM</div><div class="ttdef"><b>Definition</b> <a href="Config_8hpp_source.html#l00018">Config.hpp:18</a></div></div>
<div class="ttc" id="aConst_8hpp_html_a4a9d32ff035c82119003134767948ebf"><div class="ttname"><a href="Const_8hpp.html#a4a9d32ff035c82119003134767948ebf">NX</a></div><div class="ttdeci">#define NX</div><div class="ttdef"><b>Definition</b> <a href="Const_8hpp_source.html#l00012">Const.hpp:12</a></div></div>
<div class="ttc" id="aConst_8hpp_html_a693aee47b2103d0a7fcd3a0a0dd4fb57"><div class="ttname"><a href="Const_8hpp.html#a693aee47b2103d0a7fcd3a0a0dd4fb57">NZ</a></div><div class="ttdeci">#define NZ</div><div class="ttdef"><b>Definition</b> <a href="Const_8hpp_source.html#l00013">Const.hpp:13</a></div></div>
<div class="ttc" id="aclassvvm_html_a88f21d908dca06f5c725da83a36caf96"><div class="ttname"><a href="classvvm.html#a88f21d908dca06f5c725da83a36caf96">vvm::BoundaryProcess2D_westdown</a></div><div class="ttdeci">static void BoundaryProcess2D_westdown(double var[][NZ])</div><div class="ttdef"><b>Definition</b> <a href="Boundary_8cpp_source.html#l00021">Boundary.cpp:21</a></div></div>
<div class="ttc" id="aclassvvm_html_ac87ca230e4801653418101e80a986b5b"><div class="ttname"><a href="classvvm.html#ac87ca230e4801653418101e80a986b5b">vvm::A</a></div><div class="ttdeci">Eigen::SparseMatrix&lt; double &gt; A</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00113">Declare.hpp:113</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvvm_1_1PoissonSolver_a03f3af096f7aa1861ee6512f41b5298f_cgraph.svg" width="372" height="54"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvvm_1_1PoissonSolver_a03f3af096f7aa1861ee6512f41b5298f_icgraph.svg" width="456" height="71"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a47ac6e26a9dde6ed72a178dcb92d3bab" name="a47ac6e26a9dde6ed72a178dcb92d3bab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47ac6e26a9dde6ed72a178dcb92d3bab">&#9670;&#160;</a></span>pubarTop_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vvm::PoissonSolver::pubarTop_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classvvm.html">vvm</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>model</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PoissonSolver_8cpp_source.html#l00535">535</a> of file <a class="el" href="PoissonSolver_8cpp_source.html">PoissonSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  535</span>                                             {</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordtype">double</span> rhouwUp = 0., rhouwDown = 0.;</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordtype">double</span> prhouwb_pz_rhob = 0.;</div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a>-1; i++) {</div>
<div class="line"><span class="lineno">  539</span>        rhouwUp += 0.25 * (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-1]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-1] + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2]) * (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-1] + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i-1][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-1]);</div>
<div class="line"><span class="lineno">  540</span>        rhouwDown += 0.25 * (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3]*<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#ad7c0652b11cf78af50e5b03e593e1774">u</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-3]) * (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2] + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a42bbd446ef820ca6930ed4c727cf17ea">w</a>[i-1][<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2]);</div>
<div class="line"><span class="lineno">  541</span>    }</div>
<div class="line"><span class="lineno">  542</span>    rhouwUp /= ((double) (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a> - 2.));</div>
<div class="line"><span class="lineno">  543</span>    rhouwDown /= ((double) (<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a54019773003b18a98f267df45ee230bb">nx</a> - 2.));</div>
<div class="line"><span class="lineno">  544</span>    prhouwb_pz_rhob = (rhouwUp - rhouwDown) * <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a68ea5e54b9a54c4256969b5ba5dd4cbd">rdz</a> / <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a460b941aba46eeaf9d777d93ec472cc1">rhou</a>[<a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a1c19d7dc2ab861379c3c69c7e79bd5c8">nz</a>-2];</div>
<div class="line"><span class="lineno">  545</span>    <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a2494ade44221bcd3aed164d73bf208f4">ubarTopp</a> = <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a418daede3a9c0ed998842ff792647f2f">ubarTopm</a> + <a class="code hl_variable" href="main_8cpp.html#a5e376a387fdce5400f2e8ed865388257">model</a>.<a class="code hl_variable" href="classvvm.html#a35038a3310f0394ec73c928ff9801f84">d2t</a> * (-prhouwb_pz_rhob);</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  547</span>}</div>
<div class="ttc" id="aclassvvm_html_a35038a3310f0394ec73c928ff9801f84"><div class="ttname"><a href="classvvm.html#a35038a3310f0394ec73c928ff9801f84">vvm::d2t</a></div><div class="ttdeci">double d2t</div><div class="ttdoc">Integration time step.</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00037">Declare.hpp:37</a></div></div>
<div class="ttc" id="aclassvvm_html_a418daede3a9c0ed998842ff792647f2f"><div class="ttname"><a href="classvvm.html#a418daede3a9c0ed998842ff792647f2f">vvm::ubarTopm</a></div><div class="ttdeci">double ubarTopm</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00040">Declare.hpp:40</a></div></div>
<div class="ttc" id="aclassvvm_html_a68ea5e54b9a54c4256969b5ba5dd4cbd"><div class="ttname"><a href="classvvm.html#a68ea5e54b9a54c4256969b5ba5dd4cbd">vvm::rdz</a></div><div class="ttdeci">double rdz</div><div class="ttdoc">1 / dz</div><div class="ttdef"><b>Definition</b> <a href="Declare_8hpp_source.html#l00031">Declare.hpp:31</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvvm_1_1PoissonSolver_a47ac6e26a9dde6ed72a178dcb92d3bab_icgraph.svg" width="456" height="54"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/Aaron/2DVVM/full/0402/model/src/<a class="el" href="Declare_8hpp_source.html">Declare.hpp</a></li>
<li>/home/Aaron/2DVVM/full/0402/model/src/<a class="el" href="PoissonSolver_8cpp_source.html">PoissonSolver.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classvvm.html">vvm</a></li><li class="navelem"><a class="el" href="classvvm_1_1PoissonSolver.html">PoissonSolver</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
